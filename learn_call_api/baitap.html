<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <title>VNExpress Giáo dục (RSS) - Trần Hạc Hương Thư</title>
        <style>
            :root {
                color-scheme: light;
                font-family: "Segoe UI", Arial, sans-serif;
            }

            body {
                margin: 0;
                min-height: 100vh;
                background: linear-gradient(180deg, #e9f0ff 0%, #ffffff 55%, #f2f6ff 100%);
                color: #1f2937;
                display: flex;
                justify-content: center;
                padding: 48px 18px;
            }

            .container {
                width: min(1180px, 100%);
                background: #ffffff;
                border-radius: 24px;
                box-shadow:
                    0 40px 80px -60px rgba(15, 23, 42, 0.65),
                    0 16px 44px -30px rgba(30, 41, 59, 0.3);
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }

            header {
                padding: 36px 42px 24px;
                background:
                    radial-gradient(circle at top left, rgba(37, 99, 235, 0.26) 0, transparent 55%),
                    radial-gradient(circle at top right, rgba(236, 72, 153, 0.22) 0, transparent 60%),
                    #ffffff;
                border-bottom: 1px solid rgba(148, 163, 184, 0.25);
            }

            header h1 {
                margin: 0;
                font-size: clamp(2rem, 3vw, 2.8rem);
                font-weight: 700;
                color: #1d4ed8;
                letter-spacing: 0.01em;
            }

            header p {
                margin: 12px 0 0;
                color: #475569;
                font-size: 1rem;
            }

            .status-bar {
                margin: 24px 42px 0;
                padding: 16px 20px;
                border-radius: 14px;
                background: rgba(37, 99, 235, 0.08);
                border: 1px solid rgba(37, 99, 235, 0.2);
                color: #1d4ed8;
                display: flex;
                gap: 12px;
                align-items: flex-start;
                font-size: 0.98rem;
            }

            .status-bar strong {
                flex-shrink: 0;
                color: #0f172a;
            }

            .grid-wrapper {
                padding: 28px 42px 44px;
            }

            .feed-grid {
                display: grid;
                gap: 24px;
                grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
                justify-items: stretch;
            }

            .feed-card {
                background: linear-gradient(160deg, rgba(248, 250, 252, 0.95), rgba(229, 234, 245, 0.95));
                border-radius: 18px;
                padding: 20px;
                box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.25);
                display: flex;
                flex-direction: column;
gap: 12px;
                min-height: 250px;
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }

            .feed-card:hover {
                transform: translateY(-6px);
                box-shadow:
                    0 24px 35px -24px rgba(37, 99, 235, 0.6),
                    inset 0 0 0 1px rgba(37, 99, 235, 0.3);
            }

            .feed-card h2 {
                margin: 0;
                font-size: 1.05rem;
                line-height: 1.45;
                color: #1e3a8a;
            }

            .feed-card h2 a {
                color: inherit;
                text-decoration: none;
            }

            .feed-card h2 a:hover,
            .feed-card h2 a:focus {
                text-decoration: underline;
            }

            .feed-card time {
                font-size: 0.84rem;
                color: #64748b;
            }

            .feed-card p {
                margin: 0;
                color: #3f4f6a;
                font-size: 0.95rem;
                line-height: 1.55;
                flex: 1;
            }

            .feed-card figure {
                margin: 0;
                border-radius: 14px;
                overflow: hidden;
                background: #ffffff;
                border: 1px solid rgba(148, 163, 184, 0.35);
                height: 140px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .feed-card img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .empty-state {
                text-align: center;
                color: #94a3b8;
                font-style: italic;
                padding: 32px 0;
                font-size: 1rem;
            }

            @media (max-width: 1024px) {
                .grid-wrapper,
                header,
                .status-bar {
                    padding-left: 28px;
                    padding-right: 28px;
                }
            }

            @media (max-width: 720px) {
                body {
                    padding: 28px 14px;
                }

                header {
                    padding: 26px 24px 18px;
                }

                .status-bar {
                    margin: 20px 24px 0;
                    flex-direction: column;
                }

                .grid-wrapper {
                    padding: 24px;
                }

                .feed-grid {
                    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
                <h1>VNExpress Giáo dục</h1>
                <p>Tổng hợp các bài viết mới nhất từ nguồn RSS Giáo dục của VNExpress.</p>
            </header>

            <div class="status-bar">
<strong>Trạng thái</strong>
                <span id="status_text">Đang tải dữ liệu từ nguồn RSS...</span>
            </div>

            <div class="grid-wrapper">
                <div class="feed-grid" id="feed_grid">
                    <p class="empty-state">Chưa có dữ liệu hiển thị.</p>
                </div>
            </div>
        </div>

        <script>
            const proxyEndpoint = "https://api.allorigins.win/get?url=";
            const rssUrl = "https://vnexpress.net/rss/giao-duc.rss";
            const apiUrl = proxyEndpoint + encodeURIComponent(rssUrl);

            function updateStatus(message, isError) {
                const statusText = document.getElementById("status_text");
                statusText.textContent = message;
                statusText.style.color = isError ? "#b91c1c" : "#1d4ed8";
            }

            function extractImage(descriptionHtml) {
                const match = descriptionHtml.match(/<img[^>]+src="([^">]+)"/i);
                return match ? match[1] : "";
            }

            function cleanDescription(htmlString) {
                const temp = document.createElement("div");
                temp.innerHTML = htmlString;
                const text = temp.textContent || temp.innerText || "";
                return text.trim().replace(/\s+/g, " ");
            }

            function formatPubDate(pubDateText) {
                if (!pubDateText) {
                    return "";
                }

                const parsed = new Date(pubDateText);
                if (Number.isNaN(parsed.getTime())) {
                    return pubDateText;
                }

                return parsed.toLocaleString("vi-VN", {
                    year: "numeric",
                    month: "2-digit",
                    day: "2-digit",
                    hour: "2-digit",
                    minute: "2-digit",
                });
            }

            function renderCards(items) {
                const grid = document.getElementById("feed_grid");
                grid.innerHTML = "";

                if (!items.length) {
                    grid.innerHTML = '<p class="empty-state">Nguồn RSS hiện không có bài viết.</p>';
                    return;
                }

                items.forEach(function (item) {
                    const title = item.querySelector("title")?.textContent?.trim() || "Không có tiêu đề";
                    const link = item.querySelector("link")?.textContent?.trim() || "#";
                    const descriptionHtml = item.querySelector("description")?.textContent || "";
                    const pubDateText = item.querySelector("pubDate")?.textContent?.trim() || "";

                    const card = document.createElement("article");
                    card.className = "feed-card";

                    const heading = document.createElement("h2");
                    const anchor = document.createElement("a");
anchor.href = link;
                    anchor.target = "_blank";
                    anchor.rel = "noopener noreferrer";
                    anchor.textContent = title;
                    heading.appendChild(anchor);
                    card.appendChild(heading);

                    const pubDate = formatPubDate(pubDateText);
                    if (pubDate) {
                        const time = document.createElement("time");
                        time.textContent = pubDate;
                        const parsed = new Date(pubDateText);
                        if (!Number.isNaN(parsed.getTime())) {
                            time.dateTime = parsed.toISOString();
                        }
                        card.appendChild(time);
                    }

                    const description = cleanDescription(descriptionHtml);
                    if (description) {
                        const paragraph = document.createElement("p");
                        paragraph.textContent = description;
                        card.appendChild(paragraph);
                    }

                    const imageSrc = extractImage(descriptionHtml);
                    if (imageSrc) {
                        const figure = document.createElement("figure");
                        const image = document.createElement("img");
                        image.src = imageSrc;
                        image.alt = title;
                        image.loading = "lazy";
                        figure.appendChild(image);
                        card.appendChild(figure);
                    }

                    grid.appendChild(card);
                });
            }

            function loadRss() {
                updateStatus("Đang tải dữ liệu từ nguồn RSS...", false);

                fetch(apiUrl)
                    .then(function (response) {
                        if (!response.ok) {
                            throw new Error("Không thể tải RSS. Mã trạng thái: " + response.status);
                        }
                        return response.json();
                    })
                    .then(function (data) {
                        if (!data || !data.contents) {
                            throw new Error("Phản hồi từ proxy không hợp lệ.");
                        }

                        const parser = new DOMParser();
                        const xmlDoc = parser.parseFromString(data.contents, "application/xml");
                        const parseError = xmlDoc.querySelector("parsererror");
                        if (parseError) {
                            throw new Error("Không thể phân tích RSS: " + parseError.textContent);
                        }

                        const items = Array.from(xmlDoc.querySelectorAll("item"));
                        renderCards(items);
                        updateStatus("Đã tải " + items.length + " bài viết.", false);
})
.catch(function (error) {
                        console.error("Lỗi tải RSS:", error);
                        updateStatus(
                            "Không thể tải dữ liệu RSS. Vui lòng kiểm tra kết nối hoặc thử lại sau.",
                            true
                        );
                    });
            }

            document.addEventListener("DOMContentLoaded", loadRss);
        </script>
    </body>
</html>

